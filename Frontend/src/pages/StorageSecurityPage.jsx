const IconLayers = ({ size = 16 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 2 7 12 12 22 7 12 2" /><polyline points="2 17 12 22 22 17" /><polyline points="2 12 12 17 22 12" /></svg>
);
const IconSave = ({ size = 16 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" /><polyline points="17 21 17 13 7 13 7 21" /><polyline points="7 3 7 8 15 8" /></svg>
);
const IconFolder = ({ size = 14 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z" /></svg>
);
const IconFile = ({ size = 14 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z" /><polyline points="13 2 13 9 20 9" /></svg>
);
const IconZap = ({ size = 16 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" /></svg>
);
const IconDollar = ({ size = 16 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="1" x2="12" y2="23" /><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" /></svg>
);
const IconTrash = ({ size = 16 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6" /><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" /></svg>
);
const IconTrendUp = ({ size = 16 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18" /><polyline points="17 6 23 6 23 12" /></svg>
);
const IconLock = ({ size = 16 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2" /><path d="M7 11V7a5 5 0 0 1 10 0v4" /></svg>
);
const IconKey = ({ size = 16 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4" /></svg>
);
const IconEye = ({ size = 16 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" /><circle cx="12" cy="12" r="3" /></svg>
);
const IconFileText = ({ size = 16 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" /><polyline points="14 2 14 8 20 8" /><line x1="16" y1="13" x2="8" y2="13" /><line x1="16" y1="17" x2="8" y2="17" /><polyline points="10 9 9 9 8 9" /></svg>
);
const IconRefresh = ({ size = 16 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 4 23 10 17 10" /><polyline points="1 20 1 14 7 14" /><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15" /></svg>
);
const IconGlobe = ({ size = 16 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10" /><line x1="2" y1="12" x2="22" y2="12" /><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" /></svg>
);
const IconShield = ({ size = 16 }) => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" /></svg>
);

function StorageSecurityPage() {
    return (
        <div className="page-container">
            <div className="page-header">
                <div>
                    <h1 className="page-title">Storage & Security</h1>
                    <p className="page-subtitle">Partitioning strategy, access controls, and schema design documentation</p>
                </div>
            </div>

            { }
            <section className="dashboard-section">
                <div className="section-title">
                    <span className="icon" style={{ background: "rgba(232,93,117,0.08)", color: "#E85D75" }}>
                        <IconLayers />
                    </span>
                    Star Schema Design
                </div>
                <div className="schema-diagram animate-in">
                    { }
                    <div className="schema-fact">
                        <div className="schema-card fact-card">
                            <div className="schema-card-header fact">Fact Table</div>
                            <div className="schema-card-title">fact_sales</div>
                            <ul className="schema-cols">
                                <li><span className="col-key">PK</span> order_id</li>
                                <li><span className="col-key">FK</span> customer_id</li>
                                <li><span className="col-key">FK</span> product_id</li>
                                <li>order_date</li>
                                <li>quantity</li>
                                <li>unit_price</li>
                                <li>revenue</li>
                                <li>country</li>
                            </ul>
                        </div>
                    </div>

                    { }
                    <div className="schema-dimensions">
                        {[
                            { name: "dim_customer", cols: ["customer_id (PK)", "name", "email", "segment", "country", "valid_from", "valid_to", "is_current"], scd: true },
                            { name: "dim_product", cols: ["product_id (PK)", "description", "stock_code", "category", "weight_gms", "importance", "valid_from", "valid_to"], scd: true },
                            { name: "dim_date", cols: ["date_key (PK)", "full_date", "day", "month", "quarter", "year", "is_weekend"], scd: false },
                            { name: "dim_warehouse", cols: ["warehouse_id (PK)", "block_name", "region", "capacity", "manager"], scd: false },
                            { name: "fact_shipment", cols: ["shipment_id (PK)", "order_id (FK)", "warehouse_id (FK)", "shipment_mode", "delivery_status", "discount_offered", "customer_rating"], scd: false },
                        ].map((dim, i) => (
                            <div key={i} className="schema-card dim-card animate-in" style={{ animationDelay: `${i * 0.08}s` }}>
                                <div className={`schema-card-header ${dim.scd ? "scd" : dim.name === "fact_shipment" ? "fact" : "dim"}`}>
                                    {dim.scd ? "SCD Type 2" : dim.name === "fact_shipment" ? "Fact Table" : "Dimension"}
                                </div>
                                <div className="schema-card-title">{dim.name}</div>
                                <ul className="schema-cols">
                                    {dim.cols.map((c, j) => <li key={j}>{c}</li>)}
                                </ul>
                                {dim.scd && <div className="scd-badge">Tracks History</div>}
                            </div>
                        ))}
                    </div>

                    { }
                    <div className="schema-relations-label">← Foreign Key Relationships →</div>
                </div>
            </section>

            { }
            <section className="dashboard-section">
                <div className="section-title">
                    <span className="icon" style={{ background: "rgba(255,178,107,0.12)", color: "#FFB26B" }}>
                        <IconSave />
                    </span>
                    Storage Format: Parquet vs CSV
                </div>
                <div className="card animate-in" style={{ padding: "var(--space-xl)", overflow: "auto" }}>
                    <table className="comparison-table">
                        <thead>
                            <tr>
                                <th>Feature</th>
                                <th>CSV</th>
                                <th className="highlight-col">Parquet ★</th>
                            </tr>
                        </thead>
                        <tbody>
                            {[
                                ["Format", "Row-based text", "Columnar binary"],
                                ["Compression", "None (raw text)", "Snappy/GZIP (60-80% smaller)"],
                                ["Schema", "Not embedded", "Self-describing metadata"],
                                ["Read Speed", "Full scan required", "Column pruning + predicate pushdown"],
                                ["Write Speed", "Fast (append)", "Moderate (encoding overhead)"],
                                ["Type Safety", "None (all strings)", "Strong typing (int, float, timestamp)"],
                                ["Partitioning", "Manual", "Native support"],
                                ["Our Choice", "—", "Used for all fact/dim tables"],
                            ].map(([feature, csv, parquet], i) => (
                                <tr key={i}>
                                    <td className="feature-name">{feature}</td>
                                    <td>{csv}</td>
                                    <td className="highlight-col">{parquet}</td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            </section>

            { }
            <section className="dashboard-section">
                <div className="section-title">
                    <span className="icon" style={{ background: "rgba(16,185,129,0.08)", color: "#10b981" }}>
                        <IconFolder size={16} />
                    </span>
                    Partitioning Strategy
                </div>
                <div className="partition-visual animate-in">
                    <div className="card" style={{ padding: "var(--space-xl)" }}>
                        <div className="partition-tree">
                            <div className="ptree-root">
                                <span className="ptree-icon"><IconFolder /></span> data_warehouse/
                            </div>
                            <div className="ptree-level-1">
                                <div className="ptree-branch">
                                    <span className="ptree-icon"><IconFolder /></span> fact_sales/
                                    <div className="ptree-level-2">
                                        <div className="ptree-leaf"><span className="ptree-icon"><IconFolder /></span> year=2010/</div>
                                        <div className="ptree-leaf"><span className="ptree-icon"><IconFolder /></span> year=2011/
                                            <div className="ptree-level-3">
                                                <div className="ptree-file"><span className="ptree-icon"><IconFile /></span> month=01/ <span className="ptree-size">part-00001.parquet (2.1MB)</span></div>
                                                <div className="ptree-file"><span className="ptree-icon"><IconFile /></span> month=02/ <span className="ptree-size">part-00001.parquet (1.8MB)</span></div>
                                                <div className="ptree-file ptree-more">... (12 partitions/year)</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div className="ptree-branch">
                                    <span className="ptree-icon"><IconFolder /></span> fact_shipment/
                                    <div className="ptree-level-2">
                                        <div className="ptree-leaf"><span className="ptree-icon"><IconFolder /></span> warehouse=A/ <span className="ptree-size">shipments.parquet</span></div>
                                        <div className="ptree-leaf"><span className="ptree-icon"><IconFolder /></span> warehouse=B/ <span className="ptree-size">shipments.parquet</span></div>
                                        <div className="ptree-file ptree-more">... (5 warehouses)</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div className="partition-benefits">
                            <h4>Benefits</h4>
                            <div className="benefits-grid">
                                {[
                                    { icon: <IconZap />, title: "Query Performance", desc: "Scan only relevant partitions, skip 90%+ of data" },
                                    { icon: <IconDollar />, title: "Cost Efficiency", desc: "Read less data → lower I/O, faster execution" },
                                    { icon: <IconTrash />, title: "Data Lifecycle", desc: "Drop old partitions without rewriting entire table" },
                                    { icon: <IconTrendUp />, title: "Scalability", desc: "Add new partitions as data grows, no schema changes" },
                                ].map((b, i) => (
                                    <div key={i} className="benefit-item">
                                        <span className="benefit-icon" style={{ color: "var(--accent-primary)" }}>{b.icon}</span>
                                        <div>
                                            <strong>{b.title}</strong>
                                            <p>{b.desc}</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            { }
            <section className="dashboard-section">
                <div className="section-title">
                    <span className="icon" style={{ background: "rgba(224,195,252,0.2)", color: "#c9a0f0" }}>
                        <IconKey />
                    </span>
                    Access Control Matrix (RBAC)
                </div>
                <div className="card animate-in" style={{ padding: "var(--space-xl)", overflow: "auto" }}>
                    <table className="comparison-table rbac-table">
                        <thead>
                            <tr>
                                <th>Permission</th>
                                <th>Analyst</th>
                                <th>Manager</th>
                                <th>Admin</th>
                            </tr>
                        </thead>
                        <tbody>
                            {[
                                ["View Dashboards", "Yes", "Yes", "Yes"],
                                ["Run Analytics Queries", "Yes", "Yes", "Yes"],
                                ["Export Reports", "No", "Yes", "Yes"],
                                ["View Raw Data", "No", "Yes (masked PII)", "Yes"],
                                ["Modify Pipelines", "No", "No", "Yes"],
                                ["Manage Users", "No", "No", "Yes"],
                                ["Delete Data", "No", "No", "Yes (audit logged)"],
                            ].map(([perm, analyst, manager, admin], i) => (
                                <tr key={i}>
                                    <td className="feature-name">{perm}</td>
                                    <td>{analyst}</td>
                                    <td>{manager}</td>
                                    <td>{admin}</td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            </section>

            { }
            <section className="dashboard-section">
                <div className="section-title">
                    <span className="icon" style={{ background: "rgba(232,93,117,0.08)", color: "#E85D75" }}>
                        <IconShield />
                    </span>
                    Security Measures
                </div>
                <div className="security-grid">
                    {[
                        { icon: <IconLock size={24} />, title: "Encryption at Rest", desc: "All Parquet files encrypted using AES-256. Encryption keys managed separately from data storage." },
                        { icon: <IconKey size={24} />, title: "API Authentication", desc: "FastAPI endpoints secured with JWT tokens. Rate limiting applied to prevent abuse. CORS configured for authorized domains." },
                        { icon: <IconEye size={24} />, title: "Data Masking", desc: "PII fields (customer name, email) are masked for Analyst role. Full data only visible to Admin or via approved queries." },
                        { icon: <IconFileText size={24} />, title: "Audit Logging", desc: "All data access and modification events logged with timestamps, user IDs, and IP addresses for compliance." },
                        { icon: <IconRefresh size={24} />, title: "Backup & Recovery", desc: "Daily automated backups with 30-day retention. Point-in-time recovery (PITR) capability for critical datasets." },
                        { icon: <IconGlobe size={24} />, title: "Network Security", desc: "API served over HTTPS. Internal communication via private VPC. Firewall rules restrict access to authorized IPs." },
                    ].map((s, i) => (
                        <div key={i} className="card security-card animate-in" style={{ animationDelay: `${i * 0.08}s` }}>
                            <div className="security-icon" style={{ color: "var(--accent-primary)" }}>{s.icon}</div>
                            <h4>{s.title}</h4>
                            <p>{s.desc}</p>
                        </div>
                    ))}
                </div>
            </section>
        </div>
    );
}

export default StorageSecurityPage;
